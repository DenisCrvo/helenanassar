// --- C칍DIGO PARA O FORMUL츼RIO ---

// 1. Cole aqui a URL do seu aplicativo da web do Google Apps Script.
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyXR13dWG_A4OJt4aO4s0wOpHGzNG8TODbxJrRALhWDO3jChxcuqXGR3uGwAuwDJGkIZA/exec';

// 2. Pega os elementos do HTML que vamos usar.
const form = document.getElementById('form-presenca');
const statusMessage = document.getElementById('mensagem-status');
const submitButton = form.querySelector('.submit-button');

// 3. Adiciona um "ouvinte" para quando o formul치rio for enviado.
form.addEventListener('submit', e => {
    e.preventDefault(); // Impede que a p치gina recarregue.

    // Mostra uma mensagem de "enviando" e desabilita o bot칚o para evitar cliques duplos.
    statusMessage.textContent = "Enviando sua confirma칞칚o...";
    statusMessage.style.color = "#333"; // Cor neutra para a mensagem de envio
    submitButton.disabled = true;

    // 4. Envia os dados do formul치rio para o Google Sheets.
    fetch(SCRIPT_URL, {
        method: 'POST',
        body: new FormData(form)
    })
    .then(response => response.json())
    .then(data => {
        if (data.result === 'success') {
            // Se deu certo, mostra uma mensagem de sucesso.
            statusMessage.textContent = "Obrigado! Sua presen칞a foi confirmada com sucesso! 游꿨";
            statusMessage.style.color = "green";
            form.reset(); // Limpa os campos do formul치rio.
        } else {
            // Se o script retornou um erro, mostra o erro.
            throw new Error(data.error || 'Ocorreu um erro desconhecido.');
        }
    })
    .catch(error => {
        // Se ocorreu um erro de rede ou outro problema, mostra uma mensagem de erro.
        statusMessage.textContent = "Oops! Algo deu errado. Por favor, tente novamente.";
        statusMessage.style.color = "red";
        console.error('Erro ao enviar:', error.message);
    })
    .finally(() => {
        // Reabilita o bot칚o de envio, independentemente do resultado.
        submitButton.disabled = false;
    });
});


// --- C칍DIGO PARA MOSTRAR/ESCONDER O FORMUL츼RIO ---

const rsvpBtn = document.getElementById('rsvp-btn');
const formArea = document.getElementById('form-area');

rsvpBtn.addEventListener('click', (e) => {
    e.preventDefault(); // Impede o link de pular para a 칙ncora #form-area
    
    // Mostra a 치rea do formul치rio com um efeito suave
    if (formArea.style.display === 'none') {
        formArea.style.opacity = 0;
        formArea.style.display = 'block';
        setTimeout(() => {
            formArea.style.transition = 'opacity 0.5s ease-in-out';
            formArea.style.opacity = 1;
        }, 10);
        
        // Esconde o bot칚o principal
        rsvpBtn.style.display = 'none';
    }
});
